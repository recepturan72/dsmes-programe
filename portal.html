
<!DOCTYPE html>
<html lang='tr'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Diyabet Portal</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
  <style>
    body{font-family:Arial, sans-serif;margin:20px;}
    nav button{margin-right:10px;padding:8px 12px;}
    .tab{display:none;margin-top:20px;}
    .visible{display:block;}
    form input, form select{margin:4px 0;padding:6px;}
    .record, .entry{border-bottom:1px solid #ccc;padding:4px 0;}
  </style>
</head>
<body>
  <h2>ðŸ”‘ Diyabet Hasta PortalÄ±</h2>
  <div id="loginDiv">
    <input type="email" id="email" placeholder="E-posta"><br>
    <input type="password" id="password" placeholder="Åžifre"><br>
    <button onclick="kayitOl()">KayÄ±t Ol</button>
    <button onclick="girisYap()">GiriÅŸ Yap</button>
  </div>

  <div id="portal" style="display:none;">
    <button onclick="cikisYap()">ðŸšª Ã‡Ä±kÄ±ÅŸ</button>
    <nav>
      <button onclick="showTab('seker')">ðŸ“Š Kan Åžekeri</button>
      <button onclick="showTab('tanitici')">ðŸ“‘ TanÄ±tÄ±cÄ± Bilgi</button>
      <button onclick="showTab('doys')">ðŸ“‘ DÃ–YS</button>
      <button onclick="showTab('dds')">ðŸ“‘ DDS</button>
    </nav>

    <div id="seker" class="tab">
      <h3>ðŸ“Š Kan Åžekeri Takibi</h3>
      <input type="number" id="glucose" placeholder="Kan Åžekeri (mg/dl)"><br>
      <input type="text" id="note" placeholder="Not (Ã¶rn. kahvaltÄ± sonrasÄ±)"><br>
      <button onclick="kaydetSeker()">Kaydet</button>
      <h4>GeÃ§miÅŸ Ã–lÃ§Ã¼mlerim:</h4>
      <div id="sekerList"></div>
    </div>

    <div id="tanitici" class="tab">
      <h3>ðŸ“‘ TanÄ±tÄ±cÄ± Bilgi Formu</h3>
      <form id="taniticiForm">
        <label>Cinsiyet: <select name="cinsiyet"><option>KadÄ±n</option><option>Erkek</option></select></label><br>
        <label>YaÅŸ: <input type="number" name="yas"></label><br>
        <label>EÄŸitim: <select name="egitim"><option>Ä°lkÃ¶ÄŸretim</option><option>Lise</option><option>Ãœniversite</option><option>LisansÃ¼stÃ¼</option></select></label><br>
        <label>Meslek: <input type="text" name="meslek"></label><br>
        <label>Medeni Durum: <select name="medeni"><option>Bekar</option><option>Evli</option></select></label><br>
        <label>Diyabet TanÄ± YÄ±lÄ±: <input type="number" name="taniYili"></label><br>
        <label>Tedavi TÃ¼rÃ¼: <select name="tedavi"><option>OAD</option><option>Ä°nsÃ¼lin</option><option>OAD+Ä°nsÃ¼lin</option></select></label><br>
        <label>Ek HastalÄ±klar: <input type="text" name="ekHastaliklar"></label><br>
        <button type="button" onclick="kaydetForm('TanÄ±tÄ±cÄ±')">Kaydet</button>
      </form>
      <div id="taniticiList"></div>
    </div>

    <div id="doys" class="tab">
      <h3>ðŸ“‘ DÃ–YS â€“ 16 Madde</h3>
      <form id="doysForm">
        <!-- 16 madde 0â€“3 likert -->
        <p>1- DÃ–YS soru 1: <select name='q1'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>2- DÃ–YS soru 2: <select name='q2'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>3- DÃ–YS soru 3: <select name='q3'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>4- DÃ–YS soru 4: <select name='q4'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>5- DÃ–YS soru 5: <select name='q5'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>6- DÃ–YS soru 6: <select name='q6'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>7- DÃ–YS soru 7: <select name='q7'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>8- DÃ–YS soru 8: <select name='q8'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>9- DÃ–YS soru 9: <select name='q9'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>10- DÃ–YS soru 10: <select name='q10'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>11- DÃ–YS soru 11: <select name='q11'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>12- DÃ–YS soru 12: <select name='q12'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>13- DÃ–YS soru 13: <select name='q13'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>14- DÃ–YS soru 14: <select name='q14'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>15- DÃ–YS soru 15: <select name='q15'><option>3</option><option>2</option><option>1</option><option>0</option></select></p><p>16- DÃ–YS soru 16: <select name='q16'><option>3</option><option>2</option><option>1</option><option>0</option></select></p>
        <button type="button" onclick="kaydetForm('DÃ–YS')">Kaydet</button>
      </form>
      <div id="doysList"></div>
    </div>

    <div id="dds" class="tab">
      <h3>ðŸ“‘ DDS â€“ 8 Madde</h3>
      <form id="ddsForm">
        <p>1- DDS soru 1: <select name='q1'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p><p>2- DDS soru 2: <select name='q2'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p><p>3- DDS soru 3: <select name='q3'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p><p>4- DDS soru 4: <select name='q4'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p><p>5- DDS soru 5: <select name='q5'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p><p>6- DDS soru 6: <select name='q6'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p><p>7- DDS soru 7: <select name='q7'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p><p>8- DDS soru 8: <select name='q8'><option>1</option><option>2</option><option>3</option><option>4</option><option>5</option><option>6</option></select></p>
        <button type="button" onclick="kaydetForm('DDS')">Kaydet</button>
      </form>
      <div id="ddsList"></div>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB88e2t5AgqdhHFtb_a2konmaE2HHahiGk",
      authDomain: "diyabetportal.firebaseapp.com",
      projectId: "diyabetportal",
      storageBucket: "diyabetportal.appspot.com",
      messagingSenderId: "771103540098",
      appId: "1:771103540098:web:d1031e184531d4f3ea459b"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    function kayitOl(){
      auth.createUserWithEmailAndPassword(
        document.getElementById('email').value,
        document.getElementById('password').value
      ).catch(e=>alert(e.message));
    }
    function girisYap(){
      auth.signInWithEmailAndPassword(
        document.getElementById('email').value,
        document.getElementById('password').value
      ).then(()=>{
        document.getElementById('loginDiv').style.display='none';
        document.getElementById('portal').style.display='block';
      }).catch(e=>alert(e.message));
    }
    function cikisYap(){auth.signOut();location.reload();}

    function showTab(id){
      document.querySelectorAll('.tab').forEach(t=>t.classList.remove('visible'));
      document.getElementById(id).classList.add('visible');
    }

    function kaydetSeker(){
      const user = auth.currentUser; if(!user){alert('GiriÅŸ yapÄ±n');return}
      db.collection('records').add({
        uid:user.uid,
        glucose:document.getElementById('glucose').value,
        note:document.getElementById('note').value,
        createdAt:new Date()
      }).then(listeleSeker);
    }
    function listeleSeker(){
      const user = auth.currentUser; if(!user) return;
      db.collection('records').where('uid','==',user.uid).get().then(snap=>{
        let out=''; snap.forEach(doc=>{const d=doc.data(); out+=`<div class='record'>${d.glucose} mg/dl (${d.note||''})</div>`});
        document.getElementById('sekerList').innerHTML=out;
      });
    }

    function kaydetForm(scale){
      const user = auth.currentUser; if(!user){alert('GiriÅŸ yapÄ±n');return}
      const form=document.getElementById(scale==="TanÄ±tÄ±cÄ±"?"taniticiForm":(scale==="DÃ–YS"?"doysForm":"ddsForm"));
      const data={};[...form.elements].forEach(el=>{if(el.name) data[el.name]=el.value;});
      db.collection('forms').add({ uid:user.uid, scale, answers:data, createdAt:new Date() })
        .then(()=>{listeleForm(scale);});
    }
    function listeleForm(scale){
      const user = auth.currentUser; if(!user) return;
      db.collection('forms').where('uid','==',user.uid).where('scale','==',scale).get().then(snap=>{
        let out=''; snap.forEach(doc=>{const d=doc.data(); out+=`<div class='entry'>${JSON.stringify(d.answers)}</div>`});
        document.getElementById(scale.toLowerCase()+"List").innerHTML=out;
      });
    }
  </script>
</body>
</html>
